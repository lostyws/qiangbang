!function(a,b){function c(b){var c={autoOpen:!0,buttons:null,closeBtn:!0,mask:!0,width:"auto",height:"auto",title:null,content:null,scrollMove:!0,container:null,maskClick:function(){},open:function(){},close:function(){},position:null};this._options=a.extend({},c,b),this._init()}function d(){if(null!=window.pageXOffset)return{x:window.pageXOffset,y:window.pageYOffset};var a=window.document;return"CSS1Compat"===document.compatMode?{x:a.documentElement.scrollLeft,y:a.documentElement.scrollTop}:{x:a.body.scrollLeft,y:a.body.scrollTop}}var e={close:'<a class="ui-dialog-close" title="关闭"><span class="">x</span></a>',mask:'<div class="ui-mask"></div>',title:'<div class="ui-dialog-title"><h3><%=title%></h3></div>',wrap:'<div class="ui-dialog"><div class="ui-dialog-content"></div><% if(btns){ %><div class="ui-dialog-footer ui-dialog-btns"><% for(var i=0, length=btns.length; i<length; i++){var item = btns[i]; %><a class="btn btn-warning ui-btn-<%=item.index%> ui-btn" data-key="<%=item.key%>"><%=item.text%></a><% } %></div><% } %></div> '};c.prototype.getWrap=function(){return this._options._wrap},c.prototype._init=function(){var b,c=this,d=c._options,f=0,g=a.proxy(c._eventHandler,c),h={};d._container=a(d.container||document.body),(d._cIsBody=d._container.is("body"))||d._container.addClass("ui-dialog-container"),h.btns=b=[],d.buttons&&a.each(d.buttons,function(a){b.push({index:++f,text:a,key:a})}),d._mask=d.mask?a(e.mask).appendTo(d._container):null,d._wrap=a(a.parseTpl(e.wrap,h)).appendTo(d._container),d._content=a(".ui-dialog-content",d._wrap),d._title=a(e.title),d._close=d.closeBtn&&a(e.close).highlight("ui-dialog-close-hover"),c.$el=c.$el||d._content,c.title(d.title),c.content(d.content),b.length&&a(".ui-dialog-btns .ui-btn",d._wrap).highlight("ui-state-hover"),a(window).on("ortchange",g),d._wrap.on("click",g),d._mask&&d._mask.on("click",g),d.autoOpen&&c.open()},c.prototype._create=function(){var a=this._options;this._options.setup&&(a.content=a.content||this.$el.show(),a.title=a.title||this.$el.attr("title"))},c.prototype._eventHandler=function(b){var c,d,e,f=this,g=f._options;switch(b.type){case"ortchange":this.refresh();break;case"touchmove":g.scrollMove&&b.preventDefault();break;case"click":if(g._mask&&(a.contains(g._mask[0],b.target)||g._mask[0]===b.target))return g.maskClick.call(this);d=g._wrap.get(0),(c=a(b.target).closest(".ui-dialog-close",d))&&c.length?f.close():(c=a(b.target).closest(".ui-dialog-btns .ui-btn",d))&&c.length&&(e=g.buttons[c.attr("data-key")],e&&e.apply(f,arguments))}},c.prototype._calculate=function(){var b,c,e,f=this,g=f._options,h=document.body,i={},j=g._cIsBody,k=Math.round;return g.mask&&(i.mask=j?{width:"100%",height:Math.max(h.scrollHeight,h.clientHeight)-1}:{width:"100%",height:"100%"}),b=g._wrap.outerWidth(),c=g._wrap.outerHeight(),e=a(window),i.wrap={left:"50%",marginLeft:-k(b/2)+"px",top:j?k(e.height()/2)+d().y:"50%",marginTop:-k(c/2)+"px"},i},c.prototype.refresh=function(){var a,b,c=this,d=c._options;return d._isOpen&&(b=function(){a=c._calculate(),a.mask&&d._mask.css(a.mask),d._wrap.css(a.wrap)},document.activeElement&&/input|textarea|select/i.test(document.activeElement.tagName)?(document.body.scrollLeft=0,setTimeout(b,200)):b()),c},c.prototype.open=function(c,d){var e=this._options;return e._isOpen=!0,e._wrap.css("display","block"),e._mask&&e._mask.css("display","block"),c!==b&&this.position?this.position(c,d):this.refresh(),a(document).on("touchmove",a.proxy(this._eventHandler,this)),e.open.call(this)},c.prototype.close=function(){var b=this._options;return b._isOpen=!1,b._wrap.css("display","none"),b._mask&&b._mask.css("display","none"),a(document).off("touchmove",this._eventHandler),b.close.call(this)},c.prototype.title=function(a){var c=this._options,d=a!==b;return d&&(a=(c.title=a)?"<h3>"+a+"</h3>":a,a&&c._title.html(a).prependTo(c._wrap),c._close&&c._close.prependTo(c.title?c._title:c._wrap)),d?this:c.title},c.prototype.content=function(a){var c=this._options,d=a!==b;return d&&c._content.empty().append(c.content=a),d?this:c.content},c.prototype.destroy=function(){var b=this._options,c=this._eventHandler;a(window).off("ortchange",c),a(document).off("touchmove",c),b._wrap.off("click",c).remove(),b._mask&&b._mask.off("click",c).remove(),b._close&&b._close.highlight()},a.extend({Dialog:function(){var a=Array.prototype.slice.call(arguments,0)[0];return new c(a)}})}(jQuery);